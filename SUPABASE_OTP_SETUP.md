# إعداد OTP في Supabase

## المشكلة الحالية
عند استخدام Email للدخول، Supabase يرسل **Magic Link** (رابط في الإيميل) بدلاً من **OTP Code** (6 أرقام).

## الحل: تفعيل Email OTP في Supabase

### الخطوات (يجب تنفيذها يدوياً):

1. **افتح Supabase Dashboard**
   - اذهب إلى: https://supabase.com/dashboard
   - اختر المشروع: `pczhhuzpspruiubxxhys`

2. **اذهب إلى Authentication Settings**
   - من القائمة الجانبية: `Authentication` → `Providers`
   - ابحث عن `Email`

3. **تفعيل Email OTP**
   - في قسم `Email` Provider
   - ابحث عن خيار: **"Enable Email OTP"** أو **"Secure email change"**
   - قم بتفعيله ✅

4. **تعديل Email Templates (اختياري)**
   - اذهب إلى: `Authentication` → `Email Templates`
   - اختر: `Magic Link` template
   - يمكنك تخصيص الرسالة لتكون أكثر وضوحاً بأنها تحتوي على OTP

5. **حفظ التغييرات**
   - اضغط `Save` في أسفل الصفحة

---

## البديل: استخدام Magic Link (الحل المؤقت)

إذا كنت تريد استخدام Magic Link بدلاً من OTP:
- الكود الحالي يدعم Magic Link
- المستخدم يضغط على الرابط في الإيميل
- يتم تسجيل الدخول تلقائياً

---

## ملاحظات مهمة

### الفرق بين OTP و Magic Link:

| الميزة | Email OTP | Magic Link |
|--------|-----------|------------|
| **الأمان** | أعلى (الكود لا يعمل إلا مرة واحدة) | متوسط (الرابط يمكن استخدامه عدة مرات) |
| **UX** | المستخدم يدخل الكود يدوياً | المستخدم يضغط على الرابط فقط |
| **الصلاحية** | 60 ثانية عادة | عدة دقائق |
| **التنفيذ** | يتطلب تفعيل في Supabase | مفعّل افتراضياً |

### الكود الحالي:
- ✅ يدعم **Google OAuth**
- ✅ يدعم **Email OTP** (إذا تم تفعيله في Supabase)
- ✅ يدعم **Magic Link** (كبديل مؤقت)

---

## اختبار OTP بعد التفعيل:

1. افتح: https://bietalreef.ae/login
2. أدخل بريدك الإلكتروني
3. اضغط "إرسال رمز التحقق"
4. تحقق من بريدك - يجب أن تصلك رسالة تحتوي على **6 أرقام**
5. أدخل الأرقام في الصفحة
6. اضغط "تسجيل الدخول"

---

## إذا لم يعمل OTP:

تأكد من:
- ✅ تم تفعيل "Email OTP" في Supabase Dashboard
- ✅ تم حفظ التغييرات
- ✅ تم تحديث الصفحة (Clear Cache: Ctrl+Shift+R)
- ✅ البريد الإلكتروني صحيح

---

## الدعم الفني:

إذا واجهت مشاكل:
1. تحقق من Supabase Logs: `Authentication` → `Logs`
2. تحقق من Browser Console (F12)
3. راسلني بالخطأ المحدد
